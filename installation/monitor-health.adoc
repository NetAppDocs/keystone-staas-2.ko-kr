---
sidebar: sidebar 
permalink: installation/monitor-health.html 
keywords: monitoring system health 
summary: 데이터를 사용할 수 있는지 확인하려면 HTTP 요청을 지원하는 모니터링 시스템을 사용하여 Keystone Collector의 상태를 모니터링할 수 있습니다. 
---
= Keystone Collector의 상태를 모니터링합니다.
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
HTTP 요청을 지원하는 모니터링 시스템을 사용하여 Keystone Collector의 상태를 모니터링할 수 있습니다.  상태를 모니터링하면 Keystone 대시보드에서 데이터를 사용할 수 있는지 확인하는 데 도움이 됩니다.

기본적으로 Keystone Health 서비스는 localhost 이외의 다른 IP에서의 연결을 허용하지 않습니다.  Keystone 상태 종료점은 다음과 같습니다. `/uber/health` 그리고 Keystone Collector 서버의 모든 인터페이스에서 포트를 수신합니다. `7777` .  쿼리 시 JSON 출력이 포함된 HTTP 요청 상태 코드가 엔드포인트에서 응답으로 반환되며, Keystone Collector 시스템의 상태를 설명합니다.  JSON 본문은 전반적인 상태를 제공합니다. `is_healthy` 속성은 부울이고 구성 요소별 상태의 자세한 목록입니다. `component_details` 기인하다.  다음은 그 예입니다.

[listing]
----
$ curl http://127.0.0.1:7777/uber/health
{"is_healthy": true, "component_details": {"vicmet": "Running", "ks-collector": "Running", "ks-billing": "Running", "chronyd": "Running"}}
----
반환되는 상태 코드는 다음과 같습니다.

* *200*: 모니터링되는 모든 구성 요소가 정상임을 나타냅니다.
* *503*: 하나 이상의 구성 요소가 정상적이지 않음을 나타냅니다.
* *403*: 상태를 쿼리하는 HTTP 클라이언트가 허용된 네트워크 CIDR 목록인 _허용_ 목록에 없음을 나타냅니다.  이 상태에서는 건강 정보가 반환되지 않습니다.  _allow_ 목록은 네트워크 CIDR 방식을 사용하여 어떤 네트워크 장치가 Keystone 상태 시스템을 쿼리할 수 있는지 제어합니다.  이 오류가 발생하면 * Keystone Collector 관리 TUI > 구성 > 상태 모니터링*에서 모니터링 시스템을 _허용_ 목록에 추가하세요.


.Linux 사용자는 다음과 같은 알려진 문제에 유의하세요.

NOTE: *문제 설명*: Keystone Collector는 사용량 측정 시스템의 일부로 여러 컨테이너를 실행합니다.  Red Hat Enterprise Linux 8.x 서버가 미국 국방 정보 시스템 기관(DISA) 보안 기술 구현 가이드(STIG) 정책으로 강화되었을 때 fapolicyd(파일 액세스 정책 데몬)와 관련된 알려진 문제가 간헐적으로 나타났습니다.  이 문제는 다음과 같이 식별됩니다.link:https://bugzilla.redhat.com/show_bug.cgi?id=1907870["버그 1907870"^] .  *해결 방법*: Red Hat Enterprise에서 해결할 때까지 NetApp 다음을 수행하여 이 문제를 해결할 것을 권장합니다. `fapolicyd` 허용 모드로 전환.  ~ 안에/`etc/fapolicyd/fapolicyd.conf` , 값을 설정하다 `permissive = 1` .



== 시스템 로그 보기

Keystone Collector 시스템 로그를 보고 시스템 정보를 검토하고 해당 로그를 사용하여 문제 해결을 수행할 수 있습니다.  Keystone Collector는 호스트의 _journald_ 로깅 시스템을 사용하고, 시스템 로그는 표준 _journalctl_ 시스템 유틸리티를 통해 검토할 수 있습니다.  로그를 조사하려면 다음과 같은 주요 서비스를 이용할 수 있습니다.

* ks-컬렉터
* ks-헬스
* ks-자동 업데이트


주요 데이터 수집 서비스 _ks-collector_는 JSON 형식으로 로그를 생성합니다. `run-id` 각 예약된 데이터 수집 작업과 연관된 속성입니다.  다음은 표준 사용 데이터 수집을 위한 성공적인 작업의 예입니다.

[listing]
----
{"level":"info","time":"2022-10-31T05:20:01.831Z","caller":"light-collector/main.go:31","msg":"initialising light collector with run-id cdflm0f74cgphgfon8cg","run-id":"cdflm0f74cgphgfon8cg"}
{"level":"info","time":"2022-10-31T05:20:04.624Z","caller":"ontap/service.go:215","msg":"223 volumes collected for cluster a2049dd4-bfcf-11ec-8500-00505695ce60","run-id":"cdflm0f74cgphgfon8cg"}

{"level":"info","time":"2022-10-31T05:20:18.821Z","caller":"ontap/service.go:215","msg":"697 volumes collected for cluster 909cbacc-bfcf-11ec-8500-00505695ce60","run-id":"cdflm0f74cgphgfon8cg"}

{"level":"info","time":"2022-10-31T05:20:41.598Z","caller":"ontap/service.go:215","msg":"7 volumes collected for cluster f7b9a30c-55dc-11ed-9c88-005056b3d66f","run-id":"cdflm0f74cgphgfon8cg"}

{"level":"info","time":"2022-10-31T05:20:48.247Z","caller":"ontap/service.go:215","msg":"24 volumes collected for cluster a9e2dcff-ab21-11ec-8428-00a098ad3ba2","run-id":"cdflm0f74cgphgfon8cg"}

{"level":"info","time":"2022-10-31T05:20:48.786Z","caller":"worker/collector.go:75","msg":"4 clusters collected","run-id":"cdflm0f74cgphgfon8cg"}

{"level":"info","time":"2022-10-31T05:20:48.839Z","caller":"reception/reception.go:75","msg":"Sending file 65a71542-cb4d-bdb2-e9a7-a826be4fdcb7_1667193648.tar.gz type=ontap to reception","run-id":"cdflm0f74cgphgfon8cg"}

{"level":"info","time":"2022-10-31T05:20:48.840Z","caller":"reception/reception.go:76","msg":"File bytes 123425","run-id":"cdflm0f74cgphgfon8cg"}

{"level":"info","time":"2022-10-31T05:20:51.324Z","caller":"reception/reception.go:99","msg":"uploaded usage file to reception with status 201 Created","run-id":"cdflm0f74cgphgfon8cg"}
----
다음은 선택적 성능 데이터 수집을 위한 성공적인 작업의 예입니다.

[listing]
----
{"level":"info","time":"2022-10-31T05:20:51.324Z","caller":"sql/service.go:28","msg":"initialising MySql service at 10.128.114.214"}

{"level":"info","time":"2022-10-31T05:20:51.324Z","caller":"sql/service.go:55","msg":"Opening MySql db connection at server 10.128.114.214"}

{"level":"info","time":"2022-10-31T05:20:51.324Z","caller":"sql/service.go:39","msg":"Creating MySql db config object"}

{"level":"info","time":"2022-10-31T05:20:51.324Z","caller":"sla_reporting/service.go:69","msg":"initialising SLA service"}

{"level":"info","time":"2022-10-31T05:20:51.324Z","caller":"sla_reporting/service.go:71","msg":"SLA service successfully initialised"}

{"level":"info","time":"2022-10-31T05:20:51.324Z","caller":"worker/collector.go:217","msg":"Performance data would be collected for timerange: 2022-10-31T10:24:52~2022-10-31T10:29:52"}

{"level":"info","time":"2022-10-31T05:21:31.385Z","caller":"worker/collector.go:244","msg":"New file generated: 65a71542-cb4d-bdb2-e9a7-a826be4fdcb7_1667193651.tar.gz"}

{"level":"info","time":"2022-10-31T05:21:31.385Z","caller":"reception/reception.go:75","msg":"Sending file 65a71542-cb4d-bdb2-e9a7-a826be4fdcb7_1667193651.tar.gz type=ontap-perf to reception","run-id":"cdflm0f74cgphgfon8cg"}

{"level":"info","time":"2022-10-31T05:21:31.386Z","caller":"reception/reception.go:76","msg":"File bytes 17767","run-id":"cdflm0f74cgphgfon8cg"}

{"level":"info","time":"2022-10-31T05:21:33.025Z","caller":"reception/reception.go:99","msg":"uploaded usage file to reception with status 201 Created","run-id":"cdflm0f74cgphgfon8cg"}

{"level":"info","time":"2022-10-31T05:21:33.025Z","caller":"light-collector/main.go:88","msg":"exiting","run-id":"cdflm0f74cgphgfon8cg"}
----


== 지원 번들을 생성하고 수집합니다.

Keystone Collector TUI를 사용하면 지원 번들을 생성하고 이를 서비스 요청에 추가하여 지원 문제를 해결할 수 있습니다.  다음 절차를 따르세요.

.단계
. Keystone Collector 관리 TUI 유틸리티를 시작합니다.
`$ keystone-collector-tui`
. *문제 해결 > 지원 번들 생성*으로 이동합니다.image:tui-sup-bundl.png["투이 스크린"]
. 생성되면 번들이 저장된 위치가 표시됩니다.  FTP, SFTP 또는 SCP를 사용하여 해당 위치에 연결하고 로그 파일을 로컬 시스템에 다운로드합니다.image:tui-sup-bundl-2.png["투이 스크린"]
. 파일을 다운로드한 후 Keystone ServiceNow 지원 티켓에 첨부할 수 있습니다. 티켓 발행에 대한 정보는 다음을 참조하세요. link:../concepts/support-services.html["서비스 요청 생성"].

